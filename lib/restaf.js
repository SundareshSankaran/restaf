!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("restaf",[],t):"object"==typeof exports?exports.restaf=t():e.restaf=t()}(global,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/objectSpread")},function(e,t){e.exports=require("redux-saga/effects")},function(e,t){e.exports=require("redux-saga")},function(e,t){e.exports=require("@babel/runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("immutable")},function(e,t){e.exports=require("@babel/runtime/helpers/typeof")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("axios")},function(e,t,n){"use strict";t.setGoodStatus=function(e){return{status:e.status,statusText:e.statusText,detail:" ",error:!1}},t.setBadStatus=function(e){var t=0,n=" ";return e.hasOwnProperty("response")&&null!=e.response&&(t=e.response.status,n=e.response.hasOwnProperty("data")?e.response.data:e.response.statusText),{status:t,statusText:e.message,detail:n,error:!0}}},function(e,t){e.exports=require("query-string")},function(e,t){e.exports=require("qs")},function(e,t,n){e.exports=n(14)},function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(3),s=n.n(a),o=n(0),u=n.n(o),i=n(1),c=n.n(i),l=n(2),p=n(10),f=n(7),d=n.n(f),y=n(9),h=n.n(y),v=n(12),m=n.n(v);function g(e,t){var n=e.href.split("/"),r=n[n.length-2],a="/casProxy/servers/".concat(r,"/cas/sessions/").concat(t);return function(e,t){return[{method:"POST",href:"".concat(e,"/actions"),rel:"cashttp",uri:"".concat(e,"/actions"),responseType:"application/json",type:"application/json",itemType:"application/json",title:"Run CAS Action",customHandling:"casExecute",extended:!0},{method:"POST",href:"".concat(t,"/actions"),rel:"execute",uri:"".concat(t,"/actions"),responseType:"application/json",type:"application/json",itemType:"application/json",title:"Run CAS Action",customHandling:"casExecute",extended:!0},{method:"GET",href:"".concat(e,"/isIdle"),rel:"state",uri:"".concat(e,"/isIdle"),responseType:"application/json",type:"application/json",itemType:"application/json",title:"state",customHandling:"casState",extended:!0}]}("/".concat(e.casHttp,"/cas/sessions/").concat(t),a)}var b=function(e){var t={};for(var n in e.headers)t[n.toLowerCase()]=e.headers[n];if(e.headers=t,null==e.headers["content-type"]||"string"==typeof e.data.results)return e;var r=e.data.iconfig.link;return function(e,t){if("createSession"===e.rel&&"application/vnd.sas.cas.session"===e.responseType){var n=g(e,t.data.results.id);t.data.results.links=t.data.results.links.concat(n),t.data.results.name2=t.data.results.name.split(":")[0]}if(e.hasOwnProperty("itemType")&&"application/vnd.sas.cas.session.summary"===e.itemType)for(var r=t.data.results.items,a=0;a<r.length;a++){var s=r[a],o=g(e,s.id);s.links=s.links.concat(o)}if(e.hasOwnProperty("customHandling")&&(t.data.results=function(e){var t={};if(!1===e.hasOwnProperty("results"))return e;var n=Object.assign({},e.results);for(var r in n){var a=n[r];!0===a.hasOwnProperty("_ctb")&&!0===a._ctb&&(t[r]=Object.assign({},a))}return e.tables=t,e}(t.data.results),t.data.results={items:Object.assign({},t.data.results)},t.data.results.castomHandling=e.customHandling),"/casManagement/"!==e.href&&"/casManagement"!==e.href||"GET"!==e.method||t.data.results.links.map(function(e){return"collection"===e.rel&&(e.title="servers",e.rel="servers",e.patch="cas"),e}),e.hasOwnProperty("patch")&&"servers"===e.rel)for(var u=t.data.results.items,i=function(e){var t=u[e],n=t.name,r=t.links.map(function(e){return e.casHttp="".concat(n,"-http"),e});t.links=r},c=0;c<u.length;c++)i(c)}(r,e),function(e,t){if(e.href.indexOf("reportImages/jobs")>0&&!0===t.data.results.hasOwnProperty("images")){var n=t.data.results.images,r=!0===Array.isArray(n)?[].concat(n):Object.assign({},n);r[0].id="image",t.data.results.items=r,delete t.data.results.images}}(r,e),function(e,t){if("/reports/reports"===e.href&&"GET"===e.method)for(var n=t.data.results.items,r=0;r<n.length;r++){var a="/SASReportViewer/?reportUri=/reports/reports/".concat(n[r].id),s={method:"GET",href:a,rel:"viewer",uri:a,type:"text/html",itemType:"text/html",title:"Report Viewer",extended:!0};n[r].links.push(s)}}(r,e),e};function w(e){var t=e.link,n=Buffer.from(e.clientID+":"+e.clientSecret).toString("base64");return n="Basic "+n,x({method:t.method,url:e.host+t.href,headers:{Accept:t.responseType,"Content-Type":t.type,Authorization:n},withCredentials:!1,data:{grant_type:"password",username:e.user,password:e.password},validateStatus:function(e){return e>=200&&e<300},transformResponse:function(e){return e},transformRequest:function(e){return m.a.stringify(e)}},e)}function k(e){var t=e.link,n=e.logonInfo,r=c()({},t),a=e.hasOwnProperty("payload")?e.payload:null,s=null,o=null,u=null,i=null,l=null;null!==a&&(l=O(a,"action"),s=O(a,"qs"),o=O(a,"data"),u=O(a,"headers"),i=O(a,"xsrf"));var p="".concat(n.host).concat(r.href);"upload"===(l=null!=l?l.toLowerCase():null)&&(l="table.upload"),null!==l&&(p="".concat(p,"/").concat(l)),r.hasOwnProperty("customHandling")&&null!==l&&"table.upload"===l&&(r.method="PUT",r.type="application/octet-stream",r.responseType="application/json");var f={method:r.method,url:p,transformResponse:function(e){return e}};"server"!==n.type&&null!==n.token?f.headers={Authorization:n.tokenType+" "+n.token}:(f.headers={},f.withCredentials=!0);var y=S(r.type);if(r.hasOwnProperty("responseType")?(f.headers["Content-Type"]=y,f.headers.Accept=S(r.responseType)):null!==y&&(f.headers.Accept=y,"PUT"!==r.method&&"POST"!==r.method&&"PATCH"!==r.method||(f.headers["Content-Type"]=y)),null!==u)for(var h in u)"json-parameters"===h.toLowerCase()?f.headers[h]="object"===d()(u[h])?JSON.stringify(u[h]):u[h]:f.headers[h]=u[h];if(null!==i){var v=i["x-csrf-header"];f.xsrfHeaderName=v,f.headers[v]=i["x-csrf-token"]}return null!==s&&(f.params=c()({},s)),f.data=null===o?{}:o,f.maxContentLength=20126512,x(f,e)}function x(e,t){return new Promise(function(n,r){h()(e).then(function(e){var a;(a=e.data,new Promise(function(e,t){if("object"===d()(a))e(a);else{var n=a.replace(/\r?\n|\r/g," ");try{var r=JSON.parse(n);e(r)}catch(t){e(a)}}})).then(function(a){t.data=null,e.data={results:a,iconfig:Object.assign({},t)},a.hasOwnProperty("errorCode")?(e.status=e.data.results.httpStatusCode,e.statusText="errorCode: ".concat(e.data.results.errorCode),r({response:e})):n(b(e))}).catch(function(){t.data=null,e.data={results:e.data,iconfig:Object.assign({},t)},n(b(e))})}).catch(function(e){r(e)})})}function O(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var a=n[r];if(a.toUpperCase()===t.toUpperCase())return e[a]}return null}function S(e){var t=e;return null==t?t=null:-1!==t.indexOf("application/vnd")&&-1===t.indexOf("+json")&&(t+="+json"),t}function T(e){var t=e.link;return window.location.href="".concat(e.host+t.href,"?response_type=").concat(t.responseType,"&client_id=").concat(e.clientID),new Promise.resolve}h.a.interceptors.response.use(function(e){return e},function(e){return Promise.reject(e)});var j="VIYA_LOGON",P="BEGIN_LOGON",A="VIYA_LOGOFF",_="VIYA_LOGON_COMPLETE",I="server",C="implicit",E="ADD_SERVICE",L="API_CALL",N="API_PARALLEL",R="DELETE_RAF_OBJECT",G="API_POLL",D="_appdata",H="APP_DATA",q="APP_DATA_SETSTATE",M="_apistatus",B="API_STATUS",J="API_STATUS_SETSTATE",Y="_xsrf",F="API_XSRF",U="API_XSRF_SETSTATE",V=function(e){return"password"===e||null==e?{logon:w,link:{href:"/SASLogon/oauth/token",method:"POST",rel:"logon",responseType:"application/json",type:"application/x-www-form-urlencoded",uri:"/SASLogon/oauth/token"}}:{logon:T,link:{href:"/SASLogon/oauth/authorize",method:"GET",rel:"logon",responseType:e,uri:"/SASLogon/oauth/authorize"}}};n(6);function z(e,t,n){if(n===D||n===M||n===Y)return{structType:n,type:n,route:n,routeList:[],userData:{}};var r={structType:t,type:t,title:e,method:"GET",iconfig:{},payload:{},statusInfo:{status:0,statusText:" ",error:!1,details:" "},runStatus:"idle",parentRoute:"",route:"",resultType:"",links:{},scrollCmds:{},paginator:!1,itemsList:[],items:[],details:{},stateEvent:null,responseHeaders:{},link:null,raw:{}};return 3===arguments.length&&(r.link={method:"GET",title:n,href:"/"+n+"/",rel:"root",type:"application/vnd.sas.api",uri:"/"+n+"/"},r.route="".concat(n,":/").concat(n),r.parentRoute=n),r}var X=u.a.mark(K);function K(){var e,t,n,r;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=!0;case 1:if(!e){a.next=20;break}return a.next=4,Object(l.take)(j);case 4:return t=a.sent,a.next=7,Object(l.put)({type:P});case 7:return a.next=9,Object(l.call)(Q,t);case 9:return n=a.sent,a.next=12,Object(l.put)(n);case 12:if(!1!==n.error){a.next=18;break}return a.next=15,Object(l.take)(A);case 15:return r={type:A,payload:null},a.next=18,Object(l.put)(r);case 18:a.next=1;break;case 20:case"end":return a.stop()}},X,this)}function Q(e){var t=c()({},e.payload);if(t.authType===I||t.authType===C)return{type:t.authType,error:!1,payload:{iconfig:t}};var n=V(t.authType);return t.link=n.link,n.logon(t).then(function(e){return{type:_,error:!1,payload:e}}).catch(function(e){return{type:_,error:!0,payload:e}})}var W=K;function Z(e,t,n){return{error:n,type:t.serviceName+"_"+t.type+"_COMPLETE",config:t,payload:e}}var $=function(e){return k(e).then(function(t){return Z(t,e,!1)}).catch(function(t){return Z(t,e,!0)})};function ee(e){var t=e.connections,n=t.get("currentConnection");return-1===n?null:t.get("connections").get(n).toJS().logonInfo}var te=u.a.mark(ne);function ne(e){var t,n;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=c()({},e),r.next=3,Object(l.select)(ee);case 3:return t.logonInfo=r.sent,r.next=6,Object(l.put)({type:t.serviceName+"_"+e.type+"_BEGIN",config:t});case 6:if(!(e.delay>0)){r.next=9;break}return r.next=9,Object(a.delay)(1e3*e.delay);case 9:return r.next=11,Object(l.call)($,t);case 11:return n=r.sent,r.next=14,Object(l.put)(n);case 14:case"end":return r.stop()}},te,this)}var re=ne,ae=u.a.mark(se);function se(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Object(a.takeEvery)([E,L],re),"t0",1);case 1:case"end":return e.stop()}},ae,this)}var oe=se,ue=u.a.mark(le),ie=u.a.mark(pe),ce=u.a.mark(fe);function le(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Object(a.takeEvery)(N,pe),"t0",1);case 1:case"end":return e.stop()}},ue,this)}function pe(e){var t,n,r,a,s,o;return u.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=[],n=e.actionArray,r=0;case 3:if(!(r<n.length)){u.next=11;break}return u.next=6,Object(l.call)(fe,n[r]);case 6:a=u.sent,t.push(a);case 8:r++,u.next=3;break;case 11:return u.next=13,Object(l.all)(t.map(function(e){return Object(l.call)($,e)}));case 13:s=u.sent,o=0;case 15:if(!(o<s.length)){u.next=21;break}return u.next=18,Object(l.put)(s[o]);case 18:o++,u.next=15;break;case 21:case"end":return u.stop()}},ie,this)}function fe(e){var t;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=c()({},e),n.next=3,Object(l.select)(ee);case 3:return t.logonInfo=n.sent,n.next=6,Object(l.put)({type:t.serviceName+"_"+t.type+"_BEGIN",config:t});case 6:return n.abrupt("return",t);case 7:case"end":return n.stop()}},ce,this)}var de=le;function ye(e,t,n){return{error:n,type:t.serviceName+"_"+t.type+"_COMPLETE",config:t,payload:e}}var he=function(e){var t,n=["running","pending"];return k(e).then(function(r){var a=r.data.results;return e.eventHandler&&(t=e.eventHandler(a,e.jobContext)),-1===n.indexOf(a)||!0===t?ye(r,e,!1):null}).catch(function(n){return e.eventHandler&&(t=e.eventHandler("*SystemError",e.jobContext)),ye(n,e,!0)})},ve=u.a.mark(me);function me(e){var t,n;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=c()({},e),n=null,r.next=4,Object(l.select)(ee);case 4:return t.logonInfo=r.sent,r.next=7,Object(l.put)({type:t.serviceName+"_"+e.type+"_BEGIN",config:t});case 7:if(!t.delay){r.next=10;break}return r.next=10,Object(a.delay)(1e3*t.delay);case 10:return r.next=12,Object(l.call)(he,t);case 12:n=r.sent;case 13:if(null===n){r.next=7;break}case 14:return r.next=16,Object(l.put)(n);case 16:case"end":return r.stop()}},ve,this)}var ge=me,be=u.a.mark(we);function we(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Object(a.takeEvery)([G],ge),"t0",1);case 1:case"end":return e.stop()}},be,this)}var ke=we,xe=u.a.mark(Se),Oe=u.a.mark(Te);function Se(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Object(a.takeEvery)([H,B,F],Te),"t0",1);case 1:case"end":return e.stop()}},xe,this)}function Te(e){var t,n;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=e.type,r.next=r.t0===H?3:r.t0===B?5:7;break;case 3:return t=D+"_"+q,r.abrupt("break",9);case 5:return t=M+"_"+J,r.abrupt("break",9);case 7:return t=Y+"_"+U,r.abrupt("break",9);case 9:return n={type:t,payload:e},r.next=12,Object(l.put)(n);case 12:case"end":return r.stop()}},Oe,this)}var je=Se,Pe=u.a.mark(Ae);function Ae(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[W(),oe(),de(),ke(),je()];case 2:case"end":return e.stop()}},Pe,this)}var _e=Ae,Ie=n(6),Ce=Ie.Map,Ee=Ie.fromJS,Le=Ee({connections:[],user:"none",type:"server",currentConnection:-1,statusInfo:{status:0,statusText:" ",error:!1,details:" "},runStatus:"idle"});function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return e.set("runStatus","busy");case I:var n={type:"server",id:1,user:"You",desc:"Server",logonInfo:{type:"server",host:t.payload.iconfig.host,tokenType:null,token:null}},r={currentConnection:e.get("currentConnection")+1,runStatus:"ready",statusInfo:{},user:"You of course!",connections:[n]};return Ee(r);case C:var a=t.payload.iconfig;if(!0===t.error)return e.withMutations(function(e){e.set("runStatus","error").set("statusInfo",Ee(Object(p.setBadStatus)(t.payload)))});var s={type:"implicit",id:1,user:"You",desc:"implicit",logonInfo:c()({},a)},o={currentConnection:e.get("currentConnection")+1,runStatus:"ready",statusInfo:{},user:"You of course!",connections:[s]};return Ee(o);case _:if(!0===t.error)return e.withMutations(function(e){e.set("runStatus","error").set("statusInfo",Ee(Object(p.setBadStatus)(t.payload)))});var u={currentConnection:e.get("currentConnection")+1,runStatus:"ready",statusInfo:Object(p.setGoodStatus)(t.payload),user:t.payload.data.iconfig.user};return e.withMutations(function(e){var n,r,a,s;e.set("connections",e.get("connections").push(Ce((n=t.payload,r=n.data,a=r.results,s=r.iconfig,{type:"connection",id:1,user:s.user,desc:s.desc,logonInfo:{type:"trusted",host:s.host,tokenType:a.token_type,token:a.access_token},statusInfo:Object(p.setGoodStatus)(n)})))).merge(Ee(u))});case A:return Le;default:return e}}var Re=n(4),Ge=n.n(Re),De=function(e,t){var n=null;if(!0===e.error)return(n=z("error","error")).link=e.config.href,n.runStatus="error",n.statusInfo=Object(p.setBadStatus)(e.payload),n;var r=e.payload.data.results,a="";if(!0===r.hasOwnProperty("accept")?a=r.accept:!0===e.payload.headers.hasOwnProperty("content-type")?a=e.payload.headers["content-type"].split(";")[0].split("+json")[0]:204===e.payload.status&&(a="No Content"),r.hasOwnProperty("items"))(n=function(e,t){var n=[],r={},a=z(t[t.length-1],"links"),s={name:"",type:"",resultType:"",cmds:null,data:null};a.resultType=e.accept,a.details=function(e){var t=c()({},e);return t.hasOwnProperty("links")&&delete t.links,t.hasOwnProperty("items")&&delete t.items,t}(e),e.hasOwnProperty("name")&&(s.name=e.name);e.hasOwnProperty("links")&&(a.links=He(e.links,t,"lcmds"),a.scrollCmds=He(e.links,t,"scrollCmds"));if(!1===Array.isArray(e.items))return s.data=e.items,s.resultType=e.accept,e.items.hasOwnProperty("customHandling")?(s.type=e.items.customHandling,a.type=e.items.customHandling):(s.type="items",a.type="items"),a.items=s,a;if(0===e.items.length)return s.resultType=e.accept,s.data=[],s.type="itemsList",a.type="itemsList",a.items=s,a.itemsList=[],a;if(e.items[0].hasOwnProperty("links")){var o=-1,u=!0,i=!1,l=void 0;try{for(var p,f=e.items[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var d=p.value;o++;var y=void 0;y=d.hasOwnProperty("name2")?d.name2:d.hasOwnProperty("name")?d.name:d.hasOwnProperty("id")?d.id:"".concat(o),n.push(y);var h=Ge()(t).concat(["items","data",y]),v=He(d.links,h,"cmds"),m=c()({},d);delete m.links;var g={name:"",type:"",resultType:"",cmds:null,data:null};g.type="itemRow",g.name=y,g.resultType=!0===m.hasOwnProperty("contentType")?m.contentType:"unknown",g.cmds=v,g.data=m,r[y]=g}}catch(e){i=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(i)throw l}}s.data=r,s.resultType=e.accept,s.type="itemsList",a.itemsList=n.concat(),a.type="itemsList"}else s.data=Ge()(e.items),s.resultType=e.accept,s.type="itemsArray",a.type="itemsArray";return a.items=s,a}(r,t)).resultType=null==r.accept?a:r.accept;else if(r.hasOwnProperty("links")){n=function(e,t){var n=z(t[t.length-1],"links");if(null===e||0===e.length)return n;return n.links=He(e,t,"lcmds"),n.type="links",n.scrollCmds=He(e,t,"scrollCmds"),n}(r.links,t);var s=c()({},r);for(var o in delete s.links,s)if("version"!==o){n.type="data";break}n.items={resultType:"data",data:s,cmds:null},n.resultType=a}else(n=z("data","data")).type="data",n.resultType=a,n.items={resultType:a,data:"string"==typeof r?r:Object.assign({},r),cmds:null};n.link=e.config.link.href,n.runStatus="ready",n.statusInfo=Object(p.setGoodStatus)(e.payload);var u=e.config,i=e.payload.config,l=i.url.split("/");return n.host="".concat(l[0],"//").concat(l[2]),n.iconfig={input:{link:c()({},u.link),payload:u.hasOwnProperty("payload")?Object.assign({},u.payload):{}},http:{url:i.url,payload:{headers:[].concat(i.headers),data:null==i.data?{}:"object"===d()(i.data)?Object.assign({},i.data):i.data,qs:null==i.params?{}:"object"===d()(i.params)?Object.assign({},i.params):i.params}}},n};function He(e,t,n){var r,a=["next","prev","first","last"];r="links"===n?e:"cmds"===n||"lcmds"===n?e.filter(function(e){return!a.includes(e.rel)}):"scrollCmds"===n?e.filter(function(e){return a.includes(e.rel)}):e,"lcmds"===n&&(n="links");var s=Ge()(t).concat([n]),o={};return r.map(function(e){var r=Ge()(s).concat([e.rel]);!1===e.hasOwnProperty("title")&&(e.title=e.rel);var u={link:c()({},e),method:e.method,route:r.join(":/"),parentRoute:Ge()(t).join(":/"),paginator:a.includes(e.rel)};o[e.rel]=c()({},z(e.title,n),u)}),o}var qe=n(6).fromJS,Me=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe(z(e,"links",e)),n=arguments.length>1?arguments[1]:void 0;switch(n.type){case R:var r=n.route.split(":/").slice(1);t.getIn(r);return t.deleteIn(r);case e+"_"+E+"_BEGIN":return t.set("runStatus","busy").set("route",e);case e+"_"+E+"_COMPLETE":var a=De(n,[e]);return a.resultType="application/vnd.sas.api",a.raw=c()({},n.payload),a.responseHeaders=c()({},a.raw.headers),a.route=e,qe(a);case e+"_"+L+"_BEGIN":case e+"_"+G+"_BEGIN":var s=n.config,o=s.paginator,u=s.route.split(":/"),i=u.slice(!0===o?1:2),l=t.getIn(i);return l=l.set("runStatus","busy"),i=u.slice(1),t.setIn(i,l);case e+"_"+L+"_COMPLETE":case e+"_"+G+"_COMPLETE":var p=n.config.route.split(":/"),f=p.slice(1),d=Object.assign({},n.payload),y=De(n,p);y.raw=d,"links"===y.type&&null==y.resultType&&(y.resultType="application/vnd.sas.api");n.config.link.method;y.title=n.config.link.href,y.responseHeaders=c()({},d.headers),y.route=p.join(":/");var h=qe(y);return t.setIn(f,h);case e+"_"+H+"_SETSTATE":var v=n.payload,m=v.route,g=v.payload,b=t.get("userData");return b=Array.isArray(m)?b.setIn(m,qe(g)):b.set(m,qe(g)),t.set("userData",b);case e+"_"+F+"_SETSTATE":var w=n.payload,k=w.route,x=w.payload,O=t.get("userData");return O=Array.isArray(k)?O.setIn(k,qe(x)):O.set(k,qe(x)),t.set("userData",O);case e+"_"+B+"_SETSTATE":var S=n.payload.payload,T=S.jobContext,j=t.get("userData"),P=t.get("routeList").push(T);return j=j.set(T,qe(S)),t.set("userData",j).set("routeList",P);default:return t}}};function Be(e){return Object(r.combineReducers)(c()({connections:Ne},e))}var Je=function(e,t,n){return e.asyncReducers.hasOwnProperty(t)&&delete e.asyncReducers[t],e.asyncReducers[t]=n,e.replaceReducer(Be(e.asyncReducers)),!0};var Ye=n(6);var Fe=function(e,t,n){for(var r,a,s,o,u=[],i=[],c=arguments.length,l=new Array(c>3?c-3:0),p=3;p<c;p++)l[p-3]=arguments[p];if(null!=l&&(u=!0===Array.isArray(l[0])?l[0]:l),"string"==typeof t)s=(a=t.split(":/")).shift(),o=e.getState()[s],i=Ge()(a).concat(Ge()(u));else{if(i=u,!Ye.Iterable.isIterable(t))return null;o=t}return null==o?null:(null!==(r=i.length>0?o.getIn(i,null):o)&&!0===n&&!0===Ye.Iterable.isIterable(r)&&(r=r.keySeq()),r)};var Ue=function(e,t,n){return null!=n?Fe(e,t,!1,n):Fe(e,t)};var Ve=function(e,t,n){for(var r=null,a=arguments.length,s=new Array(a>3?a-3:0),o=3;o<a;o++)s[o-3]=arguments[o];return null!=s&&s.length>0?(r=!0===Array.isArray(s[0])?s[0]:s,null!==n&&(r=n.concat(r))):r=n,Fe(e,t,!1,r)};var ze=function(e,t){var n,r=function(n){return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return Ve(e,t,n,a)}};return{results:r(),items:r(["items","data"]),itemsCmd:(n=["items","data"],function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return a.splice(1,0,"cmds"),Ve(e,t,n,a)}),itemsList:r(["itemsList"]),links:r(["links"]),details:r(["details"]),scrollCmds:r(["scrollCmds"]),raw:r(["raw"]),headers:r(["responseHeaders"]),config:r(["iconfig"]),host:t.get("host"),resultType:t.get("resultType"),status:t.get("statusInfo").get("status"),statusInfo:t.get("statusInfo").toJS(),type:t.get("type"),route:t.get("route")}};var Xe=function(e){for(var t=e.getState()[Y],n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var s=r.length>0?["userData"].concat(r):["userData"],o=t.getIn(s,null);return null!==o?o.toJS():null},Ke=n(6),Qe=function(e,t,n,r,a,s,o,u){var i,c,l,p,f;if("string"==typeof t?(f=Ue(e,t),c=t):c=(f=t).get("route"),null===f||!1===Ke.Iterable.isIterable(f))return null;if(i=f.get("paginator"),l=f.get("link").toJS(),i)p=(c=f.get("parentRoute")).split(":/")[0];else{var d=c.split(":/");p=d[0],d.splice(1,0,e.apiCallNo),c=d.join(":/"),e.apiCallNo++}var y={type:n,delay:null==a?0:a,paginator:i,serviceName:p,route:c,eventHandler:s,parentRoute:o,jobContext:u,link:l};l.href.indexOf("casProxy")>=0&&(p="casProxy");var h=Xe(e,p);return null!=r&&(y.payload=r),null!==h&&(null!=r?y.payload.xsrf=h:y.payload={xsrf:h}),y},We=arguments,Ze=function(e,t,n,r,a,s,o,u){return new Promise(function(i,c){var l,p,f=!0,d=Qe(e,t,n,r,a,s,o,u);null===d&&c({error:"Bad route and/or rafLink",args:JSON.stringify(We,null,4)}),l=d.route,p=e.subscribe(function(){if(f)f=!1;else{var t=Ue(e,l);if(t){var n=t.get("runStatus");"error"===n?(p(),c(t.get("statusInfo"))):"ready"===n&&(p(),i(ze(e,t)))}else p(),c({error:"Hmmm! Failed to resolve route in apiCall callback - should never happen. Call Programmer",route:l})}}),e.dispatch(d)})},$e=function(e,t,n,r){return Ze(e,t,L,n,r,null)},et=function(e,t,n){return new Promise(function(r,a){var s=t.map(function(t){var r=t.rafLink,s=!0===t.hasOwnProperty("payload")?t.payload:null,o=Qe(e,r,L,s,n,null,null,null);return null===o&&a({err:"Invalid route and/or rafLink",args:JSON.stringify(t,null,4)}),o}),o=!0,u=e.subscribe(function(){if(o)o=!1;else{for(var t=[],n=0;n<s.length;n++){var i=Ue(e,s[n].route);if(null!==i){var c=i.get("runStatus");if("error"===c){u();var l={jobNo:n,detail:i.get("statusInfo")};a(l)}else"ready"===c&&t.push(ze(e,i))}}t.length===s.length&&r(t)}});e.dispatch({type:N,actionArray:s})})},tt=n(5),nt=n.n(tt);function rt(){return(rt=nt()(u.a.mark(function e(t,n,r){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e(t,n.links("execute"),r,0);case 2:if(!0!==at(a=e.sent)){e.next=5;break}throw JSON.stringify(a.items());case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function at(e){var t=e.items("disposition","statusCode"),n=e.items("disposition","severity");return 0!==t||"Error"===n}var st=function(e,t,n){return rt.apply(this,arguments)};var ot=function(e,t,n,r,a,s,o){return new Promise(function(u,i){var c=t.links("state");null===c?u({completed:1,running:0,jobState:{job:t,data:"completed",statusCode:200}}):Ze(e,c,!0===a?G:L,n,r,s,t.route,o).then(function(e){var n={},r=0,a=e.items();!1===n.hasOwnProperty(a)&&(n[a]=0),n[a]=n[a]+1;var s=e.status;"running"!==a&&"pending"!==a||(r=1),u({running:r,detail:n,jobState:{job:t,data:a,statusCode:s}})}).catch(function(e){i(e)})})};function ut(){return(ut=nt()(u.a.mark(function e(t,n,r,a,s,o,i){var c,l,p,f;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c=!1,l=1,"wait"===a?(l=1,c=!0):l=a||1;case 3:return e.next=5,ot(t,n,r,s,c,o,i);case 5:if(p=e.sent,f=p.detail.hasOwnProperty("failed"),0!==p.running){e.next=13;break}if(l=0,!1!==f){e.next=13;break}return e.next=12,$e(t,n.links("self"));case 12:p.jobState.job=e.sent;case 13:if(--l>0){e.next=3;break}case 14:return e.abrupt("return",p.jobState);case 15:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var it=function(e,t,n,r,a,s,o){return ut.apply(this,arguments)};function ct(){return(ct=nt()(u.a.mark(function e(t,n,r,a,s,o,i){var c,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i&&i("pending",s),e.next=3,Ze(t,n,L,r,0,null,null,s);case 3:if(!(c=e.sent).links("state")){e.next=12;break}return e.next=7,it(t,c,null,"wait",a,i,s);case 7:return l=e.sent,lt(t,o,l.data,l.job,s),e.abrupt("return",l.job);case 12:return lt(t,o,"unknown",c,s),e.abrupt("return",c);case 14:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function lt(e,t,n,r,a){var s={data:n,job:r,httpCode:r.status};!function(e,t,n){var r={route:t.job.route,data:t.data,jobContext:n},a={type:B,route:n,payload:r};e.dispatch(a)}(e,s,a),t&&t(null,s,a)}var pt=function(e,t,n,r,a,s,o){return ct.apply(this,arguments)};var ft=function(e,t,n){return new Promise(function(r,a){var s=[];if(null!==n)if(!1===Array.isArray(n))for(var o=0;o<t.length;o++)s.push(n);else s=Ge()(n);else for(var u=0;u<t.length;u++)s.push(null);var i=t.map(function(e,t){var n=e.links("state");null===n&&a(" job ".concat(t," does not support state checking "));var r=s[t];return{rafLink:n,payload:c()({},r)}});et(e,i).then(function(e){var n={},a=0,s=e.map(function(e,r){var s=e.items(),o=e.status;return!1===n.hasOwnProperty(s)&&(n[s]=0),n[s]=n[s]+1,"running"!==s&&"pending"!==s||a++,{job:t[r],data:s,statusCode:o}});r({running:a,detail:n,jobState:s})}).catch(function(e){a(e)})})};var dt=function(e,t,n,r){return new Promise(function(a,s){!function e(t,n,r,a,s){ft(t,n,r).then(function(o){o.running>0?--a<=0?s(null,o):e(t,n,r,a,s):s(null,o)}).catch(function(e){s(e)})}(e,t,n,null!=r?r:1,function(t,n){if(t)s(t);else if(0===n.running){var r=n.jobState.map(function(e){return{rafLink:e.job.links("self"),payload:null}});et(e,r,null).then(function(e){e.forEach(function(e,t){n.jobState[t].job=e}),a(n)}).catch(function(e){s(e)})}else a(n)})})},yt=n(9);function ht(){return(ht=nt()(u.a.mark(function e(t,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yt(t);case 2:return r=e.sent,e.abrupt("return",null==n?r:n(r));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var vt=function(e,t){return ht.apply(this,arguments)};var mt=function(e){var t=e.getState(),n=[];for(var r in t)"connections"!==r&&n.push(r);return n},gt=n(6),bt=n.n(gt),wt=function(e,t){return new Promise(function(n,r){t.forEach(function(t){!1===Je(e,t,Me(t))&&r(Object(gt.fromJS)({Error:"".concat(t,"  exists")}))});var a=t.map(function(e){return{type:E,link:{method:"GET",href:"/"+e+"/",rel:"root",type:"application/vnd.sas.api",uri:"/"+e+"/"},logonInfo:null,tLink:null,serviceName:e,route:e}}),s=!0,o=e.subscribe(function(){if(s)s=!1;else{for(var u={},i={},c=0,l=0;l<a.length;l++){var p=Ue(e,a[l].route);if(null!==p){var f=p.get("runStatus");if("error"===f){o();var d={service:t[l],detail:p.get("statusInfo")};r(d)}else if("ready"===f){c++;var y=ze(e,p);u[t[l]]=y;var h=y.headers("x-csrf-header");if(null!==h){var v={"x-csrf-header":h,"x-csrf-token":y.headers("x-csrf-token")};i[t[l]]=v}else i[t[l]]=null}}}c===a.length&&(o(),n({folders:u,xsrfTokens:i}))}});e.dispatch({type:N,interval:-1,actionArray:a})})};var kt=function(e,t,n,r){var a={type:t,route:n,payload:r};e.dispatch(a)};function xt(){return(xt=nt()(u.a.mark(function e(t){var n,r,a,s,o,i,c,l=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=l.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=l[a];return r.includes("casManagement")&&r.push("casProxy"),e.next=4,wt(t,r);case 4:if(s=e.sent,o=s.folders,null!==(i=s.xsrfTokens))for(c in i)kt(t,F,c,i[c]);return e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Ot=function(e){return xt.apply(this,arguments)};var St=function(e,t){var n=e.getState();for(var r in n)if(r===t)return ze(e,n[r]);return null},Tt=n(11),jt=n.n(Tt);var Pt=function(e,t){return new Promise(function(n,r){var a,s,o=!1,u=null==t?null:c()({},t);if(e.getState().connections.get("currentConnection")>=0)n("ready");else{if(null==u&&(u={host:"".concat(window.location.protocol,"//").concat(window.location.host),authType:I},null!=window&&null!=window.location&&window.location.hasOwnProperty("hash"))){var i=window.location,l=jt.a.parse(i.search),p=jt.a.parse(i.hash);null!==l&&null!==l.host&&(u.host=l.host,u.tokenType=null!=l.token_type?l.token_type:null,u.token=null!=l.access_token?l.access_token:null,null!==u.token&&(u.authType=C)),null!=p.access_token&&(u={host:l.host,token:p.access_token,tokenType:p.token_type,authType:C})}switch(u.authType){case I:null==u.host&&(u.host="".concat(window.location.protocol,"//").concat(window.location.host));break;case C:u.hasOwnProperty("token")||(o=!0,function(e){var t="".concat(e.host,"/SASLogon/oauth/authorize?response_type=token&client_id=").concat(e.clientID);if(null!=e.redirect){var n="".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(e.redirect,"?host=").concat(e.host);t="".concat(t,"&redirect_uri=").concat(n)}window.location.replace(t)}(u),n("Implicit Call"))}o||(s={type:"LOGOFF"===u.authType?"LOGOFF":j,payload:c()({},u)},a=e.subscribe(function(){var t=e.getState().connections,s=t.get("runStatus");"ready"===s?(a(),n(s)):"error"===s&&(a(),r(t.get("statusInfo").toJS()))}),e.dispatch(s))}})};var At=function(e){return new Promise(function(t,n){var r={type:A,payload:{}};e.subscribe(function(){t(!0)}),e.dispatch(r)})},_t=function(e){e.dispatch({type:"END"})};var It=function(e,t){var n=t.split(":/"),r=n.shift(),a=e.getState()[r];return a=n.length>0?a.getIn(n):a,ze(e,a)};var Ct=function(e,t){var n=null;if("string"==typeof t?n=t:!0===bt.a.Iterable.isIterable(t)&&(n=t.get("route")),null!==t){var r={type:R,route:n};e.dispatch(r)}};var Et=function(){var e=function(){var e=s()(),t=Object(r.createStore)(Be(),Object(r.applyMiddleware)(e));return t.asyncReducers={},t.injectAsyncReducers=Je,t.apiCallNo=0,e.run(_e),t}();return Je(e,M,Me(M)),Je(e,D,Me(D)),Je(e,Y,Me(Y)),{logon:Pt.bind(null,e),logoff:At.bind(null,e),connection:function(e){return ee(e.getState())}.bind(null,e),addServices:Ot.bind(null,e),getServices:mt.bind(null,e),apiCall:$e.bind(null,e),runAction:st.bind(null,e),apiCallAll:et.bind(null,e),rafObject:It.bind(null,e),deleteRafObject:Ct.bind(null,e),jobState:it.bind(null,e),jobStateAll:dt.bind(null,e),submit:pt.bind(null,e),submitStatus:function(e,t){var n=e.getState()[M],r=null;if(t){var a=n.getIn(["userData",t],null);null!==a&&((r=a.toJS()).job=It(e,r.route))}else r=n.get("routeList");return r}.bind(null,e),setAppData:kt.bind(null,e,H),getAppData:function(e){for(var t=e.getState()[D],n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var s=r.length>0?["userData"].concat(r):["userData"];return t.getIn(s,null)}.bind(null,e),setXsrfData:kt.bind(null,e,F),getXsrfData:Xe.bind(null,e),getState:e.getState,endStore:_t.bind(null,e),store:e,getServiceRoot:St.bind(null,e),request:vt}};n.d(t,"initStore",function(){return Et}),n.d(t,"endStore",function(){return _t}),console.log(Et)}])});